.Dd December 31, 2023
.Dt GPM 1
.Os
.Sh NAME
.Nm gpm
.Nd gpg-based secret (or password) manager
.Sh SYNOPSIS
.Nm
.Op Fl d Ar dir
.Op Fl g Ar command
.Ar command
.Op Ar arg ...
.Sh DESCRIPTION
The utility
.Nm
is a secret manager.
Secrets are stored in a directory tree as files, encrypted with
.Xr gpg 1 .
.Nm
provides several commands for manipulating secrets.
Commands may be specified by their shortest unique prefix (all characters
after are ignored).
Commands may accept additional arguments.
Commands may be preceeded by global options as follows:
.Bl -tag -width Ds
.It Fl d Ar dir
The directory to store and retrieve secrets from.
Overrides
.Ev GPM_DIR .
.It Fl g Ar command
The
.Xr gpg 1
command.
Overrides
.Ev GPM_GPG .
.El
.Pp
The
.Nm
commands are as follows:
.Bl -tag -width Ds
.It Xo
.Cm add
.Op Fl m
.Ar name
.Xc
Create a new secret
.Ar name .
The new secret is read from stdin.
If used from a TTY without the
.Fl m
flag, a single line is read twice, and not echoed.
Otherwise, an arbitrary amount of lines is read normally once.
.It Cm ls
List existing secrets, using the command in
.Ev GPM_LSCMD
if set.
.It Cm mv Ar from Ar to
Rename secret
.Ar from
to
.Ar to .
.It Cm rm Ar name ...
Remove secrets specified on the command line.
.Nm
will ask for confirmation before each removal.
.It Cm show Ar name
Decrypt the secret
.Ar name ,
and print plaintext to stdout.
.El
.Sh ENVIRONMENT
.Bl -tag -width XDG_DATA_HOME
.It Ev GPM_GPG
Shell command to invoke
.Xr gpg 1 .
.It Ev GPM_DIR
Directory in which the secrets are stored.
.It Ev GPM_LSCMD
Shell command used for the
.Nm
command
.Cm ls .
.It Ev XDG_DATA_HOME
If
.Ev XDG_DATA_HOME
is set, but
.Ev GPM_DIR
isn't, the default secret directory is
.Pa $XDG_DATA_HOME/gpm .
.El
.Sh FILES
.Bl -tag -width Ds
.It Pa $HOME/.gpm
The default secret directory if neither
.Ev GPM_DIR ,
nor
.Ev XDG_DATA_HOME
are set.
.El
.Sh EXIT STATUS
.Ex -std
.Sh EXAMPLES
Tab-completion may be set, e.g. with
.Xr ksh 1 :
.Bd -literal -offset indent
set -A complete_gpm_1 -- add ls mv rm show
set -A complete_gpm -- $(gpm ls)
.Ed
.Sh SEE ALSO
.Xr gpg 1 ,
.Xr gpg2 1 ,
.Xr pm 1
.Sh AUTHORS
.An Alexander Arkhipov Aq Mt aa@manpager.org .
